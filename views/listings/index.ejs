<% layout("/layouts/boilerplate") %>

<div class="container py-3">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-0 text-center text-md-start">WanderStay Listings</h2>
    </div>
  </div>
</div>

<!-- Search and Categories -->
<div class="container mb-4">
  <div class="row justify-content-center mb-3">
    <div class="col-12 col-md-8 col-lg-6">
      <form action="/listings" method="GET" class="input-group shadow-sm">
        <input type="text" name="search" class="form-control" placeholder="Search listings..." aria-label="Search Listings">
        <button class="btn btn-dark" type="submit"><i class="fas fa-search"></i></button>
      </form>
    </div>
  </div>

  <div class="d-flex justify-content-center flex-wrap gap-2 gap-md-3">
    <% const categories = [
         {name: 'Beach', icon: 'umbrella-beach', val: 'beach'},
         {name: 'Mountain', icon: 'mountain', val: 'mountain'},
         {name: 'City', icon: 'city', val: 'city'},
         {name: 'Forest', icon: 'tree', val: 'forest'},
         {name: 'Desert', icon: 'sun', val: 'desert'}
       ]; %>

    <% categories.forEach(c => { %>
      <a href="/listings?category=<%= c.val %>" class="btn btn-outline-secondary category-btn">
        <i class="fas fa-<%= c.icon %> fa-lg"></i><br><small><%= c.name %></small>
      </a>
    <% }); %>
  </div>
</div>

<!-- Listings Grid -->
<div class="container mb-5">
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3 g-md-4">
    <% for (let listing of allListings) { %>
      <div class="col">
        <a href="/listings/<%= listing._id %>" class="listing-link text-decoration-none">
          <div class="card shadow-sm h-100">
            <img src="<%= listing.image.url %>" class="card-img-top" alt="<%= listing.title %>" style="height: 20rem; object-fit: cover;">
            <div class="card-img-overlay"></div>
            <div class="card-body d-flex flex-column">
              <p class="card-text flex-grow-1">
                <b><%= listing.title %></b><br>
                &#8377; <%= listing.price.toLocaleString("en-In") %>
              </p>
            </div>
          </div>
        </a>
      </div>
    <% } %>
  </div>
</div>


